<!DOCTYPE html>
<html lang="en">
<head>
    {% include basics %}
    {% include main/head.html %}
</head>
{% if page.external_link==nil and page.is_separator!=true -%}
<body data-role="page" class="position-relative">
    {% include main/clip-pattern.html %}

    {%- assign postlist_id = page.postlist_id -%}
    {%- assign posts_intro = page.posts_intro | default: 50 -%}

    {%- for i_page in site.pages -%}
    {%- assign id = i_page.url | split: '/' | last -%}
    {%- if id == "index.html" -%}
    {%- assign id = i_page.url | split: '/' -%}
    {%- assign tmp = id.size | minus: 2 -%}
    {%- assign id = id[tmp] -%}
    {%- endif -%}
    {%- if id == postlist_id -%}
    {%- assign postlist_page = i_page -%}
    {%- endif -%}
    {%- endfor -%}

    {% include main/menu.html active=postlist_id %}
    {% include main/topbar.html active=postlist_id %}

    {%- if page.is_taglist -%}
    {%- assign key = page.tag -%}
    {%- assign name = "tag" -%}
    {%- assign listkey = "tags" -%}
    {%- elsif page.is_categorylist -%}
    {%- assign key = page.category -%}
    {%- assign name = "category" -%}
    {%- assign listkey = "categories" -%}
    {%- else -%}
    ERROR
    {%- endif -%}

    <noscript>
        <div class="alert alert-danger" role="alert">
            This page requires JavaScript to work correctly.
            Please enable JavaScript in your browser and reload the page.
        </div>
    </noscript>

    {% assign id = page.url | split: '/' | last | default: "home" %}
    <main class="container md-container m-between-5 mt-4 mb-5 pb-5" id="page-{{ id }}">
        <div class="mb-3">
            <h1>{{ postlist_page.title }} - {{ name }} "{{ key }}"</h1>
        </div>

        <div class="blog-overview">

            <h2 class="d-none">List of Posts</h2>
            <div class="list-group list-group-flush mx-n4 mb-4">

                {% for post in site.posts %}
                {% if post[listkey] contains key %}
                <a href="{{ relBase }}{{ post.url }}" class="list-group-item list-group-item-action px-4 py-4">
                    <article class="post-preview">
                        <div class="mb-4">
                            {% include main/post-header.html post=post head_level=3 %}
                        </div>

                        {{ post.content | truncatewords: posts_intro | strip_html | xml_escape}}
                    </article>
                    <div class="text-end link-primary">Read more</div>
                </a>
                {% endif %}
                {% endfor %}

            </div>

            <div class="d-flex justify-content-center">
                <a href="{{ relBase }}{{ postlist_page.url }}" class="btn btn-outline-primary w-fix-lg">
                    To all posts
                </a>
            </div>
        </div>
    </main>

    {% include main/cookie-hint.html %}
    {% include main/footer.html %}
</body>
{% endif -%}
</html>